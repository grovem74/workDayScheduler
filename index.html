<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
        integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous" />
    <link href="https://fonts.googleapis.com/css?family=Open+Sans&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="style.css" />
    <title>Work Day Scheduler</title>
</head>

<body>
    <header class="jumbotron text-center">
        <h1 class="display-4">Work Day Scheduler</h1>
        <p class="lead">A simple calendar app for scheduling your work day<br><br>
        <span id="date" class="lead"></span></p>
    </header>

    <div id="schedule" class="container cv">
        <div class="row">
            <div class="col"></div>
            <div id="status" class="col text-center empty">SAVED!</div>
            <div class="col"></div>
        </div>

        <div class="row">            
            <div id="hour" data-name="9" class="col hours">9am</div>
            <div class="col-8 p-0 divide">
                <textarea class="area" id="task1" name="input-task"></textarea>
            </div>
            <div class="col p-0 divide">
                <button id="save1" class="saveBtn" type="button" name="save-task1">
                    <i class="fas fa-lock-open"></i>
                </button>
            </div>
           
        </div>

        <div class="row">
            <div id="hour2" data-name="10" class="col hours">10am</div>
            <div class="col-8 p-0 divide">
                <textarea class="area" id="task2" name="input-task"></textarea>
            </div>
            <div class="col p-0 divide">
                <button id="save2" class="saveBtn" type="button" name="save-task2">
                    <i class="fas fa-lock-open"></i>
                </button>
            </div>
        </div>

        <div class="row">
            <div id="hour3" data-name="11" class="col hours">11am</div>
            <div class="col-8 p-0 divide">
                <textarea class="area" id="task3" name="input-task"></textarea>
            </div>
            <div class="col p-0 divide">
                <button id="save3" class="saveBtn" type="button" name="save-task3">
                    <i class="fas fa-lock-open"></i>
                </button>
            </div>
        </div>

        <div class="row">
            <div id="hour4" data-name="12" class="col hours">12pm</div>
            <div class="col-8 p-0 divide">
                <textarea class="area" id="task4" name="input-task"></textarea>
            </div>
            <div class="col p-0 divide">
                <button id="save4" class="saveBtn" type="button" name="save-task4">
                    <i class="fas fa-lock-open"></i>
                </button>
            </div>
        </div>

        <div class="row">
            <div id="hour5" data-name="13" class="col hours">1pm</div>
            <div class="col-8 p-0 divide">
                <textarea class="area" id="task5" name="input-task"></textarea>
            </div>
            <div class="col p-0 divide">
                <button id="save5" class="saveBtn" type="button" name="save-task5">
                    <i class="fas fa-lock-open"></i>
                </button>
            </div>
        </div>

        <div class="row">
            <div id="hour6" data-name="14" class="col hours">2pm</div>
            <div class="col-8 p-0 divide">
                <textarea class="area" id="task6" name="input-task"></textarea>
            </div>
            <div class="col p-0 divide">
                <button id="save6" class="saveBtn" type="button" name="save-task6">
                    <i class="fas fa-lock-open"></i>
                </button>
            </div>
        </div>

        <div class="row">
            <div id="hour7" data-name="15" class="col hours">3pm</div>
            <div class="col-8 p-0 divide">
                <textarea class="area" id="task7" name="input-task"></textarea>
            </div>
            <div class="col p-0 divide">
                <button id="save7" class="saveBtn" type="button" name="save-task7">
                    <i class="fas fa-lock-open"></i>
                </button>
            </div>
        </div>

        <div class="row">
            <div id="hour8" data-name="16" class="col hours">4pm</div>
            <div class="col-8 p-0 divide">
                <textarea class="area" id="task8" name="input-task"></textarea>
            </div>
            <div class="col p-0 divide">
                <button id="save8" class="saveBtn" type="button" name="save-task8">
                    <i class="fas fa-lock-open"></i>
                </button>
            </div>
        </div>

        <div class="row">
            <div id="hour9" data-name="17" class="col hours">5pm</div>
            <div class="col-8 p-0 divide">
                <textarea class="area" id="task9" name="input-task"></textarea>
            </div>
            <div class="col p-0 divide">
                <button id="save9" class="saveBtn" type="button" name="save-task7">
                    <i class="fas fa-lock-open"></i>
                </button>
            </div>
        </div>

    </div>

    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>

    <script>
        var currentDate = moment().format('dddd, MMMM Do');
        var currentHour = parseInt(moment().format('HH'));
        var dateEl = document.querySelector("#date");
        var hourEl = document.querySelector("#hour");
        var hour2El = document.querySelector("#hour2");
        var hour3El = document.querySelector("#hour3");
        var hour4El = document.querySelector("#hour4");
        var hour5El = document.querySelector("#hour5");
        var hour6El = document.querySelector("#hour6");
        var hour7El = document.querySelector("#hour7");
        var hour8El = document.querySelector("#hour8");
        var hour9El = document.querySelector("#hour9");
        var taskEl = document.querySelector("#task1");
        var task2El = document.querySelector("#task2");
        var task3El = document.querySelector("#task3");
        var task4El = document.querySelector("#task4");
        var task5El = document.querySelector("#task5");
        var task6El = document.querySelector("#task6");
        var task7El = document.querySelector("#task7");
        var task8El = document.querySelector("#task8");
        var task9El = document.querySelector("#task9");
        var saveEl = document.querySelector("#save1");
        var save2El = document.querySelector("#save2");
        var save3El = document.querySelector("#save3");
        var save4El = document.querySelector("#save4");
        var save5El = document.querySelector("#save5");
        var save6El = document.querySelector("#save6");
        var save7El = document.querySelector("#save7");
        var save8El = document.querySelector("#save8");
        var save9El = document.querySelector("#save9");

        var taskElements = [taskEl, task2El, task3El, task4El, task5El, task6El, task7El, task8El, task9El];

        var taskHours = [hourEl, hour2El, hour3El, hour4El, hour5El, hour6El, hour7El, hour8El, hour9El];

        var tasks = [task1, task2, task3, task4, task5, task6, task7, task8, task9];

        var savedTasks = [];

        $("#date").text(currentDate);

        //set the background color based on the time (present, future or past)
        function timeFrame() {

            for (var i = 0; i < taskHours.length; i++) {
                var taskHour = parseInt(taskHours[i].dataset.name);

                if (currentHour > taskHour) {
                    taskElements[i].setAttribute("class", "past");
                } else if (currentHour < taskHour) {
                    taskElements[i].setAttribute("class", "future");
                } else {
                    taskElements[i].setAttribute("class", "current");
                };
            };
        }

        $(".area").click(function () {
            $(this).attr("placeholder", "");
        });

        $(".area").mouseover(function () {
            $(this).focus();
            $(this).attr("placeholder", " <New Event>");
        });

        $(".area").mouseleave(function () {
            $(this).focusout();
            $(this).attr("placeholder", "");
        });

        $(".saveBtn").click(function () {
            var savedTaskDiv = $(this).parent().siblings().children();
            var savedTask = $(this).parent().siblings().children().val();
            savedTasks.push(savedTask);
            $(this.children).attr("class", "fas fa-lock");
            $(savedTaskDiv).attr({ readonly: "readonly", style: "font-weight: 700" });
            $("#status").attr("class", "saved");           
            setTimeout(function(){ $("#status").attr("class", "empty"); }, 500)

            myFunction();

            $(this).click(unlock);                  

            function unlock() {
                $(savedTaskDiv).attr({ readonly: false, style: "" });
                $(this.children).attr("class", "fas fa-lock-open");
                $("#status").attr("class", "empty");   
            };
        });

        // Retrieve from local storage
        var localTask1 = JSON.stringify(localStorage.getItem("task1"));
        var task1 = JSON.parse(localTask1);
        var task2 = localStorage.getItem("task2");

        function myFunction() {

            localStorage.setItem("task1", JSON.stringify(savedTasks[0]));
            localStorage.setItem("task2", JSON.stringify(savedTasks[1]));
            localStorage.setItem("task3", JSON.stringify(savedTasks[2]));
            localStorage.setItem("task4", JSON.stringify(savedTasks[3]));
            localStorage.setItem("task5", JSON.stringify(savedTasks[4]));
            localStorage.setItem("task6", JSON.stringify(savedTasks[5]));
            localStorage.setItem("task7", JSON.stringify(savedTasks[6]));
            localStorage.setItem("task8", JSON.stringify(savedTasks[7]));
            localStorage.setItem("task9", JSON.stringify(savedTasks[8]));
        };

        timeFrame();

    </script>

</html>